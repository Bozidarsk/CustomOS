cd bin 2> /dev/null
if [ $? -eq 1 ]; then
mkdir bin
else
cd ..
fi

cd bin/boot 2> /dev/null
if [ $? -eq 1 ]; then
mkdir bin/boot
else
cd ../..
fi

c="g++ -ffreestanding -fno-pie -nostdlib -m32 -I include -Wall -Wextra -g -c"
asm="nasm -f elf32"

$c Kernel/kernel.c
$c Display/display.c
$c Math/math.c
$c Math/vectors.c
$c Kernel/IO/io.c
$c Kernel/IO/keyboard.c
$c Kernel/convert.c
$c Kernel/string.c
$c Kernel/Interrupts/interrupts.c

$asm Kernel/Interrupts/idt.asm -o bin/idt.o
$asm Kernel/Interrupts/isr.asm -o bin/isr.o
$asm BootLoader/entry.asm -o bin/boot/entry.o

mv *.o bin/
nasm BootLoader/loader.asm -f bin -o bin/boot/loader.bin
nasm BootLoader/zeros.asm -f bin -o bin/boot/zeros.bin

ld -Ttext 0x1000 -m elf_i386 bin/boot/entry.o bin/*.o --oformat binary -o bin/boot/os.bin
cat bin/boot/loader.bin bin/boot/os.bin bin/boot/zeros.bin > bin/boot/boot.bin
